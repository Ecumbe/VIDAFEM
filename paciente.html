<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - VIDAFEM</title>
    <link rel="stylesheet" href="css/dashboard.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <div class="overlay" id="overlay"></div>

    <nav class="sidebar" id="sidebar">
        <div class="toggle-desktop" id="toggleDesktop"><i class="fas fa-chevron-left"></i></div>
        
        <div class="sidebar-header">
            <img src="assets/logo2.png" class="logo-icon" alt="VIDAFEM">
            <span class="brand-text">Opciones</span>
        </div>

        <ul class="sidebar-menu">
            <li class="menu-item">
                <a href="#" class="menu-link active" onclick="switchView('inicio')">
                    <i class="fas fa-home"></i> <span>Inicio</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" onclick="switchView('citas')">
                    <i class="fas fa-calendar-alt"></i> <span>Mis Citas</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#" class="menu-link" onclick="switchView('historial')">
                    <i class="fas fa-file-medical-alt"></i> <span>Mis Resultados</span>
                </a>
            </li>
        </ul>

        <div style="margin-top: auto;">
             <li class="menu-item">
                <a href="#" class="menu-link" id="btnLogout" style="color: #ffb5b5;">
                    <i class="fas fa-sign-out-alt"></i> <span>Cerrar SesiÃ³n</span>
                </a>
            </li>
        </div>
    </nav>

    <div class="main-wrapper">
        <header class="top-bar">
            <div class="top-left">
                <button class="menu-toggle-mobile" id="toggleMobile"><i class="fas fa-bars"></i></button>
                <div class="user-welcome">
                    <span class="welcome-label">Bienvenida,</span>
                    <span class="user-name-display" id="patientNameDisplay">Cargando...</span>
                </div>
            </div>
            <img src="assets/logo.png" alt="Logo" class="top-right-logo">
        </header>

        <div class="dashboard-content">
            
            <section id="view-inicio" class="view-section active">
                
                <div class="card" style="background: linear-gradient(135deg, #6a1b9a, #8e24aa); color: white; border:none;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h2 style="color:white; margin-top:0;">Â¡Hola de nuevo! ðŸ‘‹</h2>
                            <p style="opacity:0.9; margin-bottom:15px;">Bienvenida a tu espacio personal VIDAFEM.</p>
                            <button class="btn-submit" onclick="openSelfSchedule()" style="background:white; color:#6a1b9a; width:auto; border:none; padding: 8px 20px; font-size: 0.9rem; font-weight:bold; cursor:pointer; border-radius:50px;">
                                <i class="fas fa-plus"></i> Agendar Cita
                            </button>
                        </div>
                        <i class="fas fa-heartbeat" style="font-size: 4rem; opacity: 0.2; display: none; @media(min-width:768px){display:block;}"></i>
                    </div>
                </div>

                <div id="dashboardGrid" class="dashboard-summary-grid">
                    <div class="summary-card card-empty">
                        <div class="summary-icon"><i class="fas fa-spinner fa-spin"></i></div>
                        <div class="summary-title">Cargando informaciÃ³n...</div>
                    </div>
                </div>

            </section>

            <section id="view-citas" class="view-section" style="display: none;">
                <h2 class="section-title">Mis Citas Agendadas</h2>
                <div id="myAppointmentsList" class="cards-grid">
                    <p>Cargando tus citas...</p>
                </div>
            </section>

            <section id="view-historial" class="view-section" style="display: none;">
                <h2 class="section-title">Resultados y DiagnÃ³sticos</h2>
                <div class="card">
                    <p style="color:#666; font-size:0.9rem;">AquÃ­ verÃ¡s los resultados de tus exÃ¡menes y diagnÃ³sticos subidos por la doctora.</p>
                </div>
                <div id="myDiagnosesList" class="cards-grid" style="margin-top:20px;">
                    <p>Buscando registros...</p>
                </div>
            </section>

        </div>
    </div>

    <div class="modal-overlay" id="modalSelfAppt">
        <div class="modal-box">
            <div class="modal-header">
                <h3>Agendar mi Cita</h3>
                <span class="close-modal" onclick="closeModal('modalSelfAppt')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="formSelfAppt">
                    <input type="hidden" id="selfId"> <div class="form-group">
                        <label>Fecha Deseada</label>
                        <input type="date" id="selfDate" required class="input-field">
                    </div>
                    <div class="form-group">
                        <label>Hora Disponible</label>
                        <select id="selfTime" class="input-field" required style="background:white;"><option value="">Elige fecha primero...</option></select>
                    </div>
                    <div class="form-group">
                        <label>Motivo de Consulta</label>
                        <select id="selfService" class="input-field"><option>Cargando servicios...</option></select>
                    </div>
                    
                    <div class="form-group" id="recBox" style="display:none; background:#fff8e1; padding:10px; border-radius:8px;">
                        <label style="color:#d35400; font-size:0.8rem;">Recomendaciones previas:</label>
                        <p id="selfRecsDisplay" style="font-size:0.9rem; color:#555; margin:0;"></p>
                    </div>

                    <div class="form-group">
                        <label>Comentario Adicional (Opcional)</label>
                        <textarea id="selfNote" class="input-field" rows="2" placeholder="Ej: Es mi primera vez..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn-submit">Confirmar Cita</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalPromo">
        <div class="modal-box" style="text-align:center; border-top: 5px solid #e67e22;">
            <div style="margin-bottom: 15px;">
                <i class="fas fa-gift" style="font-size: 3rem; color: #e67e22; animation: bounce 1.5s infinite;"></i>
            </div>
            <h2 style="color: #d35400;">Â¡Aviso Especial!</h2>
            <p id="txtPromoMsg" style="font-size: 1.2rem; margin: 20px 0; font-weight: bold; color: #333;">--</p>
            <p style="font-size: 0.9rem; color: #777;">VÃ¡lido hasta: <span id="txtPromoDate">--</span></p>

            <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
                <button class="btn-submit" onclick="promoAction('agendar')">
                    <i class="fas fa-calendar-check"></i> Â¡Quiero Agendar Ya!
                </button>
                <button class="btn-submit" style="background: #25D366;" onclick="promoAction('whatsapp')">
                    <i class="fab fa-whatsapp"></i> Preguntar por WhatsApp
                </button>
                <button onclick="closeModal('modalPromo')" style="background:none; border:none; text-decoration:underline; cursor:pointer; color:#888;">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalPatientReschedule">
        <div class="modal-box" style="max-width: 400px;">
            <div class="modal-header" style="background: #f39c12;">
                <h3 style="color:white;"><i class="fas fa-history"></i> Cambiar Fecha</h3>
                <span class="close-modal" onclick="closeModal('modalPatientReschedule')">&times;</span>
            </div>
            <div class="modal-body">
                <p style="color:#666; font-size:0.9rem; margin-bottom:15px;">Selecciona el nuevo horario deseado:</p>
                <form id="formPatientReschedule">
                    <input type="hidden" id="reschIdCita">
                    
                    <div class="form-group">
                        <label>Nueva Fecha</label>
                        <input type="date" id="reschDate" required class="input-field">
                    </div>
                    
                    <div class="form-group">
                        <label>Hora Disponible</label>
                        <select id="reschTime" required class="input-field" style="background:white;">
                            <option value="">Selecciona fecha...</option>
                        </select>
                    </div>

                    <button type="submit" class="btn-submit" style="background: #f39c12;">
                        Confirmar Cambio
                    </button>
                </form>
            </div>
        </div>
    </div>

    <style>@keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-10px);} 60% {transform: translateY(-5px);} }</style>

    <script src="js/config.js"></script>
    <script src="js/sidebar.js"></script> <script src="js/paciente.js"></script> </body>
</html>